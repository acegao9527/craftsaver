# äº²æœ‹ç”Ÿæ—¥æé†’åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ

## 1. æ¦‚è¿°
æœ¬é¡¹ç›®æ—¨åœ¨ä¸º SaveHelper å¢åŠ â€œäº²æœ‹ç”Ÿæ—¥æé†’â€åŠŸèƒ½ï¼Œæ”¯æŒå…¬å†å’Œå†œå†ç”Ÿæ—¥ï¼Œå¹¶èƒ½é€šè¿‡ä¼ä¸šå¾®ä¿¡ï¼ˆRPAï¼‰åœ¨ç‰¹å®šæ—¶é—´ç‚¹å‘é€æé†’é€šçŸ¥ã€‚

## 2. æ•°æ®åº“è®¾è®¡

æ–°å¢è¡¨ `birthday_reminders` å­˜å‚¨ç”Ÿæ—¥ä¿¡æ¯ã€‚

```sql
CREATE TABLE birthday_reminders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL COMMENT 'å§“å',
    birth_date DATE NOT NULL COMMENT 'ç”Ÿæ—¥æ—¥æœŸ (YYYY-MM-DD)',
    calendar_type VARCHAR(10) NOT NULL DEFAULT 'solar' COMMENT 'solar(å…¬å†) æˆ– lunar(å†œå†)',
    note VARCHAR(255) COMMENT 'æé†’å¤‡æ³¨/ç¥ç¦è¯­',
    is_active BOOLEAN DEFAULT TRUE COMMENT 'æ˜¯å¦å¯ç”¨',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**å­—æ®µè¯´æ˜**:
*   `birth_date`: å­˜å‚¨å‡ºç”Ÿæ—¥æœŸã€‚å¹´ä»½ç”¨äºè®¡ç®—å¹´é¾„ã€‚å¦‚æœå¹´ä»½æœªçŸ¥ï¼Œå»ºè®®å­˜ä¸º `1900` å¹´ã€‚
*   `calendar_type`: 
    *   `solar`: å…¬å†ç”Ÿæ—¥ã€‚ç›´æ¥æŒ‰æœˆæ—¥åŒ¹é…ã€‚
    *   `lunar`: å†œå†ç”Ÿæ—¥ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—æ¯å¹´å¯¹åº”çš„å…¬å†æ—¥æœŸã€‚

## 3. æ ¸å¿ƒé€»è¾‘

### 3.1 ä¾èµ–åº“
ä½¿ç”¨ `borax` åº“å¤„ç†å†œå†è½¬æ¢ã€‚

### 3.2 æ£€æŸ¥ç®—æ³• (`check_and_notify`)
æ¯å¤©ä¸Šåˆ 09:00 æ‰§è¡Œä¸€æ¬¡æ£€æŸ¥ï¼š

1.  **è·å–å½“å‰æ—¥æœŸ** (`today`)ã€‚
2.  **éå†æ‰€æœ‰å¯ç”¨çš„ç”Ÿæ—¥è®°å½•**ã€‚
3.  **è®¡ç®—ä¸‹ä¸€ä¸ªç”Ÿæ—¥çš„å…¬å†æ—¥æœŸ** (`next_solar_date`)ï¼š
    *   **å…¬å†**: å–ä»Šå¹´çš„ `MM-DD`ï¼Œå¦‚æœå·²è¿‡åˆ™å–æ˜å¹´ã€‚
    *   **å†œå†**: å°†å†œå† `Month-Day` è½¬æ¢ä¸ºå½“å¹´çš„å…¬å†æ—¥æœŸã€‚å¦‚æœè¯¥æ—¥æœŸå·²è¿‡ï¼Œåˆ™è®¡ç®—ä¸‹ä¸€å†œå†å¹´çš„å¯¹åº”å…¬å†æ—¥æœŸã€‚
4.  **è®¡ç®—å€’è®¡æ—¶** (`days_until`)ã€‚
5.  **è®¡ç®—å³å°†åˆ°è¾¾çš„å¹´é¾„** (`age`)ã€‚
6.  **åŒ¹é…æé†’è§„åˆ™**ï¼š
    *   `days_until == 7`: å‘é€â€œ7å¤©å‰é¢„å‘Šâ€ã€‚
    *   `days_until == 1`: å‘é€â€œæ˜å¤©æé†’â€ã€‚
    *   `days_until == 0`: å‘é€â€œå½“å¤©ç¥ç¦â€ã€‚

### 3.3 æé†’è¯æœ¯

*   **7å¤©å‰**: 
    > ğŸ“… **ç”Ÿæ—¥é¢„å‘Š**ï¼š
    > å†è¿‡ 7 å¤©æ˜¯ **[å¼ ä¸‰]** çš„[30å²][å†œå†]ç”Ÿæ—¥ï¼ˆ2026-01-10ï¼‰ã€‚
    > ğŸ“ å¤‡æ³¨ï¼šå–œæ¬¢å–èŒ¶
    > åˆ«å¿˜äº†å‡†å¤‡ç¤¼ç‰©å“¦ï¼

*   **1å¤©å‰**: 
    > â° **æ˜å¤©æ˜¯ç”Ÿæ—¥**ï¼š
    > æ˜å¤©å°±æ˜¯ **[å¼ ä¸‰]** çš„[30å²]ç”Ÿæ—¥å•¦ï¼
    > è®°å¾—é€ä¸Šç¥ç¦ï¼

*   **å½“å¤©**: 
    > ğŸ‚ **ç”Ÿæ—¥å¿«ä¹**ï¼š
    > ä»Šå¤©æ˜¯ **[å¼ ä¸‰]** çš„[30å²]ç”Ÿæ—¥ï¼
    > ğŸ‰ ç¥å¼ ä¸‰ç”Ÿæ—¥å¿«ä¹ï¼Œå¹³å®‰å–œä¹ï¼
    > ğŸ“ å¤‡æ³¨ä¿¡æ¯...

## 4. æ¥å£è®¾è®¡

Base URL: `/birthday`

| Method | Endpoint | Description | Payload |
| :--- | :--- | :--- | :--- |
| POST | `/add` | æ·»åŠ ç”Ÿæ—¥æé†’ | `{"name": "...", "birth_date": "YYYY-MM-DD", "calendar_type": "solar/lunar", "note": "..."}` |
| GET | `/list` | è·å–æ‰€æœ‰æé†’åˆ—è¡¨ | - |
| POST | `/test_check` | æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ£€æŸ¥ | - |

## 5. é¡¹ç›®ç»“æ„

```
src/birthday_reminder/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py       # Pydantic æ¨¡å‹
â”œâ”€â”€ router.py       # FastAPI è·¯ç”±
â”œâ”€â”€ service.py      # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (è®¡ç®— & é€šçŸ¥)
â””â”€â”€ README.md       # æœ¬æ–‡æ¡£
```

## 6. éƒ¨ç½²è¯´æ˜

*   ç¡®ä¿ `backend/requirements.txt` ä¸­åŒ…å« `borax`ã€‚
*   æœåŠ¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“è¡¨ã€‚
*   å®šæ—¶ä»»åŠ¡é»˜è®¤é…ç½®ä¸ºæ¯å¤© **09:00** è¿è¡Œã€‚
